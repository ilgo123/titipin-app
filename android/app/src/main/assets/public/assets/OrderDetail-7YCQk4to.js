import{c as u,u as w,d as k,a as z,r as l,s as C,j as e,L as _,T as P}from"./index-ClXmW7HF.js";import{C as T}from"./chevron-left-DLbePdLL.js";import{C as D}from"./clock-BXtSfbHO.js";import{C as M}from"./circle-check-D5qtfpr7.js";import{P as S}from"./package-D4vBBs2Z.js";import{M as m}from"./map-pin-IFDHxthE.js";const I=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],L=u("copy",I);const q=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],h=u("message-circle",q);function G(){const r=w(),{id:i}=k(),{user:b}=z(),[s,f]=l.useState(null),[p,g]=l.useState(!0),[d,j]=l.useState("");l.useEffect(()=>{i&&N()},[i]);const N=async()=>{try{const{data:t,error:a}=await C.from("orders").select(`
          *,
          requester:profiles!requester_id(full_name, avatar_url),
          traveler:profiles!traveler_id(full_name, avatar_url)
        `).eq("id",i).single();if(a)throw a;f(t)}catch(t){console.error("Gagal ambil detail:",t),j(t.message||"Terjadi kesalahan sistem")}finally{g(!1)}},v=t=>new Intl.NumberFormat("id-ID").format(t||0);if(p)return e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx(_,{className:"animate-spin text-slate-300"})});if(d||!s)return e.jsxs("div",{className:"h-screen flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(P,{size:48,className:"text-red-500 mb-4"}),e.jsx("h3",{className:"font-bold text-lg text-slate-900",children:"Gagal Memuat Data"}),e.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-lg mt-2 mb-6 font-mono border border-red-100",children:d||"Data tidak ditemukan"}),e.jsx("button",{onClick:()=>r("/activity"),className:"bg-slate-900 text-white px-6 py-2 rounded-xl text-sm font-bold",children:"Kembali"})]});const n=["open","taken","bought","otw","done"],c=n.indexOf(s.status),x=b.id===s.requester_id,o=x?s.traveler:s.requester,y=x?"Traveler Kamu":"Pemilik Titipan";return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-24 relative",children:[e.jsxs("div",{className:"bg-slate-900 text-white pt-8 pb-20 px-6 rounded-b-[2.5rem] relative overflow-hidden shadow-lg",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/10 rounded-full blur-3xl -mr-10 -mt-10"}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10 mb-6",children:[e.jsx("button",{onClick:()=>r(-1),className:"p-2 -ml-2 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(T,{})}),e.jsx("h1",{className:"font-bold text-lg",children:"Detail Pesanan"})]}),e.jsxs("div",{className:"text-center relative z-10",children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Total Biaya"}),e.jsxs("h2",{className:"text-3xl font-black",children:["Rp ",v(s.price+s.tip)]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 mt-2 text-xs text-slate-300 bg-white/10 py-1 px-3 rounded-full w-fit mx-auto",children:[e.jsxs("span",{className:"opacity-70",children:["ID: ",String(s.id).slice(0,8)]}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(String(s.id)),children:e.jsx(L,{size:10})})]})]})]}),e.jsxs("div",{className:"px-6 -mt-12 relative z-20 space-y-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(D,{size:18,className:"text-blue-500"})," Status Pesanan"]}),e.jsxs("div",{className:"relative flex justify-between items-center text-[10px] font-bold text-gray-400",children:[e.jsx("div",{className:"absolute top-3 left-0 w-full h-1 bg-gray-100 -z-10 rounded-full"}),e.jsx("div",{className:"absolute top-3 left-0 h-1 bg-green-500 -z-10 rounded-full transition-all duration-500",style:{width:`${c/(n.length-1)*100}%`}}),n.map((t,a)=>e.jsxs("div",{className:`flex flex-col items-center gap-1 ${c>=a?"text-green-600":""}`,children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center border-2 ${c>=a?"bg-green-500 border-green-500 text-white":"bg-white border-gray-200"}`,children:t==="done"?e.jsx(M,{size:14}):a+1}),e.jsx("span",{className:"uppercase",children:t==="otw"?"OTW":t})]},t))]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-slate-100",children:[e.jsxs("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(S,{size:18,className:"text-orange-500"})," Detail Barang"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-gray-50 pb-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Nama Barang"}),e.jsx("span",{className:"font-bold text-slate-900 text-right max-w-[60%]",children:s.item})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-50 pb-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Lokasi Pembelian"}),e.jsxs("span",{className:"font-bold text-slate-900 text-sm flex items-center gap-1",children:[e.jsx(m,{size:12})," ",s.from_location]})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-50 pb-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Tujuan Antar"}),e.jsxs("span",{className:"font-bold text-slate-900 text-sm flex items-center gap-1",children:[e.jsx(m,{size:12})," ",s.to_location]})]})]})]}),o&&e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("img",{src:o.avatar_url,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase",children:y}),e.jsx("h4",{className:"font-bold text-slate-900 flex items-center gap-1",children:o.full_name})]})]}),e.jsx("button",{onClick:()=>r("/chat",{state:{orderId:s.id}}),className:"bg-blue-50 text-blue-600 p-2 rounded-xl hover:bg-blue-100 transition-colors",children:e.jsx(h,{size:20})})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 w-full bg-white border-t border-gray-100 p-4 pb-6 z-30",children:e.jsxs("button",{onClick:()=>r("/chat",{state:{orderId:s.id}}),className:"w-full bg-slate-900 text-white py-3.5 rounded-xl font-bold text-sm shadow-lg shadow-slate-200 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(h,{size:18})," Buka Percakapan"]})})]})}export{G as default};
