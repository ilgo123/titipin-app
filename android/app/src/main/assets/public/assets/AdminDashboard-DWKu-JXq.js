import{u as w,a as k,r as l,n as r,s as a,j as e,L as y}from"./index-ClXmW7HF.js";import{S as h,L as _}from"./shield-check-Dy58KFdK.js";import{B as A}from"./building-2-QS310Gwe.js";function D(){const o=w(),{user:d}=k(),[i,x]=l.useState("withdraws"),[c,u]=l.useState([]),[f,b]=l.useState([]),[p,m]=l.useState(!0),g="prayogoilham27@gmail.com";l.useEffect(()=>{if(d?.email!==g){r.error("Ngapain? Kamu bukan Admin! ðŸ˜¡"),o("/");return}n()},[d]);const n=async()=>{m(!0);const{data:s}=await a.from("withdrawals").select("*, profiles(full_name, email)").eq("status","pending").order("created_at",{ascending:!1}),{data:t}=await a.from("profiles").select("*").eq("is_verified",!1).limit(20);u(s||[]),b(t||[]),m(!1)},j=async s=>{if(confirm(`Setujui transfer Rp ${s.amount} ke ${s.bank_name}?`))try{const{error:t}=await a.from("withdrawals").update({status:"approved"}).eq("id",s.id);if(t)throw t;r.success("Penarikan disetujui! âœ…"),n()}catch(t){r.error("Gagal: "+t.message)}},N=async s=>{if(confirm("Yakin tolak dan kembalikan saldo user?"))try{const{data:t}=await a.from("profiles").select("balance").eq("id",s.user_id).single();await a.from("profiles").update({balance:t.balance+s.amount}).eq("id",s.user_id),await a.from("withdrawals").update({status:"rejected"}).eq("id",s.id),r.success("Penarikan ditolak. Saldo dikembalikan."),n()}catch(t){r.error("Gagal: "+t.message)}},v=async s=>{confirm("Berikan centang biru user ini?")&&(await a.from("profiles").update({is_verified:!0}).eq("id",s),r.success("User Verified! ðŸ”µ"),n())};return p?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx(y,{className:"animate-spin text-slate-300"})}):e.jsxs("div",{className:"min-h-screen bg-slate-900 text-white pb-20",children:[e.jsxs("div",{className:"p-6 flex justify-between items-center border-b border-slate-800",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(h,{className:"text-green-400"})," Admin Panel"]}),e.jsxs("p",{className:"text-xs text-slate-400",children:["Login sebagai: ",d.email]})]}),e.jsx("button",{onClick:()=>o("/profile"),className:"bg-slate-800 p-2 rounded-full hover:bg-slate-700",children:e.jsx(_,{size:18})})]}),e.jsxs("div",{className:"flex border-b border-slate-800",children:[e.jsxs("button",{onClick:()=>x("withdraws"),className:`flex-1 py-4 text-sm font-bold ${i==="withdraws"?"text-white border-b-2 border-green-500 bg-slate-800":"text-slate-500 hover:text-slate-300"}`,children:["Withdraw (",c.length,")"]}),e.jsx("button",{onClick:()=>x("users"),className:`flex-1 py-4 text-sm font-bold ${i==="users"?"text-white border-b-2 border-blue-500 bg-slate-800":"text-slate-500 hover:text-slate-300"}`,children:"Users"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[i==="withdraws"&&e.jsx(e.Fragment,{children:c.length===0?e.jsx("div",{className:"text-center py-10 text-slate-600",children:"Aman, tidak ada tagihan."}):c.map(s=>e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Rp ",new Intl.NumberFormat("id-ID").format(s.amount)]}),e.jsx("p",{className:"text-xs text-slate-400",children:s.profiles?.full_name})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-xs font-bold bg-yellow-500/20 text-yellow-500 px-2 py-1 rounded",children:"PENDING"})})]}),e.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg text-sm text-slate-300 mb-4 flex items-center gap-3",children:[e.jsx(A,{size:16,className:"text-slate-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold",children:[s.bank_name," - ",s.account_number]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["A.N ",s.account_holder]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(s),className:"flex-1 py-2 bg-red-500/10 text-red-500 rounded-lg text-xs font-bold hover:bg-red-500/20",children:"Tolak"}),e.jsx("button",{onClick:()=>j(s),className:"flex-1 py-2 bg-green-500 text-white rounded-lg text-xs font-bold hover:bg-green-600",children:"Transfer"})]})]},s.id))}),i==="users"&&f.map(s=>e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("img",{src:s.avatar_url||"https://via.placeholder.com/100",className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-white",children:s.full_name}),e.jsx("p",{className:"text-xs text-slate-500 truncate max-w-[150px]",children:s.email})]})]}),e.jsx("button",{onClick:()=>v(s.id),className:"bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700",children:e.jsx(h,{size:18})})]},s.id))]})]})}export{D as default};
