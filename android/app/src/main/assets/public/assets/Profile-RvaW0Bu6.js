import{c as o,u as A,a as R,r as l,s as i,j as e,L as S,n}from"./index-ClXmW7HF.js";import{C as T}from"./chevron-left-DLbePdLL.js";import{C as q}from"./camera-BDverxKX.js";import{U as F,L as I}from"./user-Be9LNIg5.js";import{W as V}from"./wallet-BqOR6YG4.js";import{P as K}from"./plus-CFTPUeQ9.js";import{S as W,L as D}from"./shield-check-Dy58KFdK.js";import{C as H}from"./credit-card-CKxOIwSQ.js";const B=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],G=o("chevron-right",B);const O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Q=o("circle-question-mark",O);const Y=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],J=o("save",Y);const X=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Z=o("settings",X);const ee=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],se=o("shield",ee);const ae=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],te=o("star",ae);function he(){const t=A(),{user:a,clearUser:d,checkSession:m}=R(),[h,u]=l.useState(!1),[p,f]=l.useState(!0),[b,g]=l.useState(!1),[x,v]=l.useState(""),[j,w]=l.useState(null),[N,y]=l.useState(!1);l.useEffect(()=>{a?.id&&L()},[a?.id]);const L=async()=>{try{f(!0);const{data:s,error:r}=await i.from("profiles").select("full_name, avatar_url, balance, is_verified, rating, review_count").eq("id",a.id).single();r&&r.code!=="PGRST116"&&console.error("Error loading profile:",r.message),s&&(v(s.full_name||a?.user_metadata?.full_name||""),w(s.avatar_url))}catch(s){console.log("Error loading profile:",s.message)}finally{f(!1)}},U=async()=>{try{u(!0);const{error:s}=await i.from("profiles").update({full_name:x,updated_at:new Date}).eq("id",a.id);if(s)throw s;await m(),y(!1),n.success("Nama berhasil disimpan! âœ¨")}catch(s){n.error(s.message)}finally{u(!1)}},P=async s=>{try{if(g(!0),!s.target.files||s.target.files.length===0)return;const r=s.target.files[0],$=r.name.split(".").pop(),k=`${`${a.id}-${Math.random()}.${$}`}`,{error:_}=await i.storage.from("avatars").upload(k,r);if(_)throw _;const{data:z}=i.storage.from("avatars").getPublicUrl(k),{error:C}=await i.from("profiles").update({avatar_url:z.publicUrl}).eq("id",a.id);if(C)throw C;w(z.publicUrl),await m(),n.success("Foto profil baru keren! ðŸ“¸")}catch(r){n.error("Gagal upload: "+r.message)}finally{g(!1)}},M=async()=>{confirm("Yakin ingin keluar akun?")&&(await i.auth.signOut(),d(),t("/login"))},E=s=>new Intl.NumberFormat("id-ID").format(s||0);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-24 relative",children:[e.jsx("button",{onClick:()=>t("/"),className:"absolute top-6 left-6 z-30 p-2 bg-white/20 backdrop-blur-md rounded-full text-slate-900 hover:bg-white transition-all shadow-sm",children:e.jsx(T,{size:24})}),e.jsxs("div",{className:"bg-white px-6 pt-16 pb-8 rounded-b-[2.5rem] shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-64 h-64 bg-slate-50 rounded-full blur-3xl -z-10"}),e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsxs("div",{className:"relative mb-4 group cursor-pointer",children:[e.jsxs("label",{htmlFor:"single",className:"cursor-pointer block relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-lg overflow-hidden bg-slate-200",children:b||p?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100",children:e.jsx(S,{className:"animate-spin text-slate-400"})}):j?e.jsx("img",{src:j,className:"w-full h-full object-cover",alt:"Profile"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-800 text-white font-bold text-2xl",children:(x||a?.email||"U").charAt(0).toUpperCase()})}),e.jsx("div",{className:"absolute bottom-0 right-0 bg-slate-900 text-white p-2 rounded-full border-2 border-white shadow-md hover:scale-110 transition-transform",children:e.jsx(q,{size:14})})]}),e.jsx("input",{type:"file",id:"single",accept:"image/*",onChange:P,disabled:b,className:"hidden"})]}),e.jsxs("div",{className:"relative w-full max-w-[250px] flex flex-col items-center",children:[p?e.jsx("div",{className:"h-8 w-32 bg-gray-200 rounded animate-pulse mb-1"}):e.jsxs("div",{className:"relative w-full flex items-center justify-center gap-1",children:[e.jsx("input",{type:"text",value:x,onChange:s=>{v(s.target.value),y(!0)},placeholder:"Tulis Nama Kamu",className:"text-xl font-black text-slate-900 text-center bg-transparent border-b-2 border-transparent hover:border-gray-200 focus:border-slate-900 outline-none transition-colors pb-1 px-2 w-auto min-w-[100px]"}),a?.is_verified&&e.jsx("div",{className:"bg-blue-500 text-white p-0.5 rounded-full shrink-0",title:"Terverifikasi",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),!N&&e.jsx("div",{className:"absolute right-0 top-1 text-gray-300 pointer-events-none opacity-0",children:e.jsx(F,{size:14})})]}),e.jsx("p",{className:"text-sm text-gray-500 font-medium mt-1",children:a?.email}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 bg-white/50 backdrop-blur-sm px-4 py-2 rounded-xl border border-white/40 shadow-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Rating"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{size:14,className:"text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"font-black text-slate-900",children:a?.rating?a.rating.toFixed(1):"0.0"})]})]}),e.jsx("div",{className:"w-px h-6 bg-gray-200"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Review"}),e.jsx("span",{className:"font-black text-slate-900",children:a?.review_count||0})]})]}),N&&e.jsx("button",{onClick:U,disabled:h,className:"mt-4 bg-green-600 text-white px-6 py-2 rounded-full text-xs font-bold shadow-md hover:bg-green-700 transition-all flex items-center gap-2 animate-in fade-in slide-in-from-top-2",children:h?e.jsx(S,{size:14,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:14})," Simpan Nama"]})})]})]})]}),e.jsx("div",{className:"px-6 -mt-6",children:e.jsxs("div",{className:"bg-slate-900 rounded-3xl p-6 text-white shadow-xl shadow-slate-200 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-2xl transform translate-x-10 -translate-y-10"}),e.jsxs("div",{className:"flex justify-between items-start mb-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[e.jsx(V,{size:18}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"TitipPay"})]}),e.jsx("div",{className:"w-10 h-7 border border-white/20 rounded bg-gradient-to-br from-white/10 to-transparent"})]}),e.jsxs("div",{className:"mb-6 relative z-10",children:[e.jsx("p",{className:"text-xs text-slate-400 font-medium mb-1",children:"Saldo Aktif"}),e.jsxs("h2",{className:"text-3xl font-black tracking-tight",children:["Rp ",E(a?.balance)]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>t("/topup"),className:"flex-1 bg-white text-slate-900 py-3 rounded-xl font-bold text-sm hover:bg-gray-100 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(K,{size:18})," Top Up"]}),e.jsxs("button",{onClick:()=>t("/wallet-history"),className:"flex-1 bg-slate-800 text-white py-3 rounded-xl font-bold text-sm hover:bg-slate-700 active:scale-95 transition-all flex items-center justify-center gap-2",children:[e.jsx(I,{size:18})," History"]})]})]})}),e.jsxs("div",{className:"px-6 mt-8 space-y-6",children:[!a?.is_verified&&e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-3xl overflow-hidden",children:e.jsxs("button",{onClick:()=>t("/verification"),className:"w-full flex items-center justify-between p-4 hover:bg-blue-100 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-4 text-blue-700",children:[e.jsx("div",{className:"p-2 bg-white rounded-full",children:e.jsx(W,{size:20})}),e.jsx("span",{className:"font-bold text-sm",children:"Verifikasi Akun Sekarang"})]}),e.jsx(G,{size:18,className:"text-blue-300 group-hover:text-blue-700"})]})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-2",children:"Keuangan"}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsx(c,{icon:e.jsx(H,{size:20}),label:"Tarik Saldo (Withdraw)",onClick:()=>t("/withdraw")}),e.jsx("div",{className:"h-px bg-gray-50 mx-4"}),e.jsx(c,{icon:e.jsx(Z,{size:20}),label:"Pengaturan Aplikasi"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 px-2",children:"Lainnya"}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsx(c,{icon:e.jsx(Q,{size:20}),label:"Pusat Bantuan"}),e.jsx("div",{className:"h-px bg-gray-50 mx-4"}),e.jsx(c,{icon:e.jsx(se,{size:20}),label:"Kebijakan Privasi"})]})]}),e.jsxs("button",{onClick:M,className:"w-full py-4 rounded-3xl border border-red-100 bg-red-50 text-red-600 font-bold flex items-center justify-center gap-2 hover:bg-red-100 active:scale-95 transition-all",children:[e.jsx(D,{size:20}),"Keluar Aplikasi"]}),e.jsx("p",{className:"text-center text-[10px] text-gray-300 font-bold pt-4 pb-8",children:"Versi 1.0.0"})]})]})}function c({icon:t,label:a,onClick:d}){return e.jsx("button",{onClick:d,className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors group",children:e.jsxs("div",{className:"flex items-center gap-4 text-slate-600 group-hover:text-slate-900 transition-colors",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full group-hover:bg-white group-hover:shadow-sm transition-all",children:t}),e.jsx("span",{className:"font-bold text-sm",children:a})]})})}export{he as default};
